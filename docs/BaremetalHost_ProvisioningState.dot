digraph BaremetalHost {
    Created [shape=house]
    Created -> Unmanaged [label="BMC.* == \"\""]
    Created -> Registering [label="BMC.* != \"\""]

    Unmanaged [shape=doublecircle]
    Unmanaged -> Registering [label="BMC.* != \"\""]
    Unmanaged -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]

    ExternallyProvisioned [label="Externally\nProvisioned"]

    Registering -> Inspecting [label="!externallyProvisioned && NeedsHardwareInspection()"]
    Registering -> Preparing [label="!externallyProvisioned && inspectionDisabled()"]
    Registering -> ExternallyProvisioned [label="externallyProvisioned"]
    Registering -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]

    ExternallyProvisioned -> Inspecting [label="!externallyProvisioned && NeedsHardwareInspection()"]
    ExternallyProvisioned -> Preparing [label="!externallyProvisioned && !NeedsHardwareInspection()"]
    Available -> ExternallyProvisioned [label="externallyProvisioned"]

    Inspecting -> Preparing [label="done"]
    Inspecting -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]

    Preparing -> Available [label="done"]
    Preparing -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]

    Available [shape=doublecircle]
    Available -> Provisioning [label="NeedsProvisioning()"]
    Available -> Preparing [label="saveHostProvisioningSettings()"]
    Available -> Preparing [label="getHostFirmwareSettings()"]
    Available -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]
    Available -> Inspecting [label="hasInspectAnnotation()"]

    Deleting7 [shape=point]

    Provisioning -> Provisioned [label=done]
    Provisioning -> Deprovisioning [label="failed || !DeletionTimestamp.IsZero()"]

    Provisioned [shape=doublecircle]
    Provisioned -> Deprovisioning [label="provisioningCancelled()"]
    Provisioned -> Deprovisioning [label="!DeletionTimestamp.IsZero()"]

    ExternallyProvisioned [shape=doublecircle]
    ExternallyProvisioned -> PoweringOffBeforeDelete [label="!DeletionTimestamp.IsZero()"]

    Deprovisioning -> Provisioning [label="NeedsProvisioning()"]
    Deprovisioning -> Available [label="!NeedsProvisioning()"]

    Deprovisioning -> PoweringOffBeforeDelete
    PoweringOffBeforeDelete -> Deleting

    Deleting [shape=doublecircle]
}
